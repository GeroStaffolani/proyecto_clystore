{% extends 'base.html' %}

{% block title %}Inicio - ClyStore{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Bienvenido, {{ user.get_full_name|default:user.username }}</h1>
    <p class="text-secondary">Accesos directos a las tareas más comunes</p>
</div>

<!-- Tarjetas de Acciones Rápidas -->
<div class="row g-4 mb-5">
    <div class="col-md-4">
        <a href="{% url 'inventory_new_list' %}" class="text-decoration-none">
            <div class="card action-card h-100 border-0 shadow-sm">
                <div class="card-body text-center p-4">
                    <div class="action-icon mb-3">
                        <i class="fas fa-shopping-cart fa-3x text-primary"></i>
                    </div>
                    <h4 class="card-title mb-2">Vender Nuevo</h4>
                    <p class="text-secondary mb-0">Buscar en inventario y registrar una venta</p>
                </div>
            </div>
        </a>
    </div>
    
    <div class="col-md-4">
        <a href="{% url 'add_phone' %}" class="text-decoration-none">
            <div class="card action-card h-100 border-0 shadow-sm">
                <div class="card-body text-center p-4">
                    <div class="action-icon mb-3">
                        <i class="fas fa-plus-circle fa-3x text-success"></i>
                    </div>
                    <h4 class="card-title mb-2">Agregar Celular</h4>
                    <p class="text-secondary mb-0">Registrar nuevo celular al inventario</p>
                </div>
            </div>
        </a>
    </div>
    
    <div class="col-md-4">
        <a href="{% url 'inventory_new_list' %}" class="text-decoration-none">
            <div class="card action-card h-100 border-0 shadow-sm">
                <div class="card-body text-center p-4">
                    <div class="action-icon mb-3">
                        <i class="fas fa-mobile-alt fa-3x text-info"></i>
                    </div>
                    <h4 class="card-title mb-2">Inventario Nuevos</h4>
                    <p class="text-secondary mb-0">Ver todos los celulares nuevos en stock</p>
                </div>
            </div>
        </a>
    </div>
</div>

<div class="row g-4 mb-5">
    <div class="col-md-4">
        <a href="{% url 'inventory_used_list' %}" class="text-decoration-none">
            <div class="card action-card h-100 border-0 shadow-sm">
                <div class="card-body text-center p-4">
                    <div class="action-icon mb-3">
                        <i class="fas fa-boxes fa-3x text-warning"></i>
                    </div>
                    <h4 class="card-title mb-2">Ver Inventario Usados</h4>
                    <p class="text-secondary mb-0">Consultar stock completo de celulares</p>
                </div>
            </div>
        </a>
    </div>
    
    <div class="col-md-4">
        <a href="{% url 'customer_list' %}" class="text-decoration-none">
            <div class="card action-card h-100 border-0 shadow-sm">
                <div class="card-body text-center p-4">
                    <div class="action-icon mb-3">
                        <i class="fas fa-users fa-3x text-purple"></i>
                    </div>
                    <h4 class="card-title mb-2">Clientes</h4>
                    <p class="text-secondary mb-0">Gestionar base de datos de clientes</p>
                </div>
            </div>
        </a>
    </div>
    
    {% if user.is_staff %}
    <div class="col-md-4">
        <a href="{% url 'reports' %}" class="text-decoration-none">
            <div class="card action-card h-100 border-0 shadow-sm">
                <div class="card-body text-center p-4">
                    <div class="action-icon mb-3">
                        <i class="fas fa-chart-line fa-3x text-danger"></i>
                    </div>
                    <h4 class="card-title mb-2">Reportes</h4>
                    <p class="text-secondary mb-0">Ver estadísticas y reportes del negocio</p>
                </div>
            </div>
        </a>
    </div>
    {% endif %}
</div>

<!-- Actividad Reciente -->
<div class="card border-0 shadow-sm">
    <div class="card-header bg-white border-bottom">
        <h5 class="mb-0"><i class="fas fa-clock me-2 text-primary"></i>Últimas Actividades</h5>
    </div>
    <div class="card-body">
        <div class="activity-feed">
            {% if recent_phones or recent_sales %}
                {% for phone in recent_phones|slice:":5" %}
                    <div class="activity-item">
                        <div class="activity-icon bg-success">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <div class="activity-content">
                            <p class="mb-1">
                                <strong>{{ phone.model }}</strong> agregado al stock
                                <span class="badge bg-light text-dark ms-2">{{ phone.get_condition_display }}</span>
                            </p>
                            <small class="text-muted">
                                <i class="far fa-clock me-1"></i>{{ phone.created_at|timesince }} 
                                {% if phone.added_by %}
                                    • Por {{ phone.added_by.get_full_name|default:phone.added_by.username }}
                                {% endif %}
                            </small>
                        </div>
                    </div>
                {% endfor %}
                
                {% for sale in recent_sales|slice:":5" %}
                    <div class="activity-item">
                        <div class="activity-icon bg-primary">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="activity-content">
                            <p class="mb-1">
                                Venta realizada a <strong>{{ sale.customer.name }}</strong>
                                <span class="badge bg-success ms-2">${{ sale.sale_price }}</span>
                            </p>
                            <small class="text-muted">
                                <i class="far fa-clock me-1"></i>{{ sale.sale_date|timesince }}
                                • {{ sale.phone.model }}
                                {% if sale.sold_by %}
                                    • Por {{ sale.sold_by.get_full_name|default:sale.sold_by.username }}
                                {% endif %}
                            </small>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="text-center py-5">
                    <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
                    <p class="text-muted">No hay actividad reciente aún.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
